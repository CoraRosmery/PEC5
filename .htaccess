# Activar mod_expires
ExpiresActive On

# Configurar la política de caché para recursos estáticos

# CSS
<FilesMatch "\.(css)$">
    ExpiresDefault "access plus 1 year"
</FilesMatch>

# Fuentes
<FilesMatch "\.(woff|woff2|ttf|otf)$">
    ExpiresDefault "access plus 1 year"
</FilesMatch>

# Imágenes
<FilesMatch "\.(jpg|jpeg|png|gif|webp)$">
    ExpiresDefault "access plus 1 month"
</FilesMatch>

# JavaScript
<FilesMatch "\.(js)$">
    ExpiresDefault "access plus 1 year"
</FilesMatch>

# Configurar la cabecera Cache-Control para garantizar la compatibilidad con versiones anteriores de HTTP
<FilesMatch "\.(ico|pdf|flv|jpg|jpeg|png|gif|webp|js|css|swf)$">
    Header set Cache-Control "public"
</FilesMatch>

<FilesMatch "\.(xml|txt)$">
    Header set Cache-Control "public, must-revalidate, proxy-revalidate"
</FilesMatch>

<FilesMatch "\.(html|htm|php)$">
    Header set Cache-Control "private, must-revalidate"
</FilesMatch>

# Activar mod_rewrite
RewriteEngine On

# Configurar redirecciones para páginas no seguras a HTTPS (si es necesario)
# RewriteCond %{HTTPS} off
# RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Habilitar la compresión gzip para mejorar el rendimiento
<IfModule mod_deflate.c>
    # Force compression for mangled headers.
    <IfModule mod_setenvif.c>
        <IfModule mod_headers.c>
            SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s*,?\s*)+|[X~-]{4,13}$ HAVE_Accept-Encoding
            RequestHeader append Accept-Encoding "gzip,deflate" env=HAVE_Accept-Encoding
        </IfModule>
    </IfModule>

    # Compress all output labeled with one of the following MIME-types
    <IfModule mod_filter.c>
        AddOutputFilterByType DEFLATE "application/atom+xml" \
                                      "application/javascript" \
                                      "application/json" \
                                      "application/ld+json" \
                                      "application/manifest+json" \
                                      "application/rdf+xml" \
                                      "application/rss+xml" \
                                      "application/schema+json" \
                                      "application/vnd.geo+json" \
                                      "application/vnd.ms-fontobject" \
                                      "application/x-font-ttf" \
                                      "application/x-javascript" \
                                      "application/x-web-app-manifest+json" \
                                      "application/xhtml+xml" \
                                      "application/xml" \
                                      "font/eot" \
                                      "font/opentype" \
                                      "font/otf" \
                                      "font/ttf" \
                                      "image/bmp" \
                                      "image/svg+xml" \
                                      "image/vnd.microsoft.icon" \
                                      "image/x-icon" \
                                      "text/cache-manifest" \
                                      "text/calendar" \
                                      "text/css" \
                                      "text/html" \
                                      "text/javascript" \
                                      "text/plain" \
                                      "text/markdown" \
                                      "text/vcard" \
                                      "text/vnd.rim.location.xloc" \
                                      "text/vtt" \
                                      "text/x-component" \
                                      "text/x-cross-domain-policy" \
                                      "text/xml"
    </IfModule>
</IfModule>

# Configurar cabeceras de seguridad
<IfModule mod_headers.c>
    Header set X-XSS-Protection "1; mode=block"
    Header set X-Content-Type-Options "nosniff"
    Header set Referrer-Policy "strict-origin-when-cross-origin"
    Header set Feature-Policy "geolocation 'self'; midi 'self'; sync-xhr 'self'; microphone 'self'; camera 'self'; magnetometer 'self'; gyroscope 'self'; speaker 'self'; fullscreen 'self'; payment 'self';"
</IfModule>

# Deshabilitar la visualización del directorio
Options -Indexes

# Configurar la política de caché para recursos estáticos
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/webp "access plus 1 month"
    ExpiresByType image/svg+xml "access plus 1 month"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/x-javascript "access plus 1 month"
    ExpiresByType application/font-woff "access plus 1 month"
    ExpiresByType application/x-font-woff "access plus 1 month"
    ExpiresByType application/font-woff2 "access plus 1 month"
    ExpiresByType application/x-font-woff2 "access plus 1 month"
    ExpiresByType font/woff "access plus 1 month"
    ExpiresByType font/woff2 "access plus 1 month"
    ExpiresByType application/vnd.ms-fontobject "access plus 1 month"
    ExpiresByType application/x-font-opentype "access plus 1 month"
    ExpiresByType application/x-font-ttf "access plus 1 month"
    ExpiresByType application/x-font-truetype "access plus 1 month"
    ExpiresByType application/x-font-otf "access plus 1 month"
    ExpiresByType application/font-sfnt "access plus 1 month"
    ExpiresByType application/font-sfnt "access plus 1 month"
    ExpiresByType font/ttf "access plus 1 month"
    ExpiresByType font/opentype "access plus 1 month"
    ExpiresByType font/otf "access plus 1 month"
    ExpiresByType application/vnd.ms-opentype "access plus 1 month"
</IfModule>

# Redirección de páginas de error personalizadas (opcional)
# ErrorDocument 404 /error.html

# Bloquear acceso a archivos sensibles (opcional)
# <FilesMatch "\.(htaccess|htpasswd|ini|phps|fla|psd|log|sh)$">
#     Order Allow,Deny
#     Deny from all
# </FilesMatch>

# Bloquear acceso a directorios sensibles (opcional)
# <DirectoryMatch "^\.|/\.">
#     Order Allow,Deny
#     Deny from all
# </DirectoryMatch>
